<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Content-Based Movie Recommender</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <h1>Content-Based Movie Recommender</h1>
        <p class="instructions">
            Select a movie you like and we will find similar ones for you based on cosine similarity over genres.
        </p>

        <!-- Classic content-based recommender (cosine similarity) -->
        <section class="section-block">
            <h2 class="section-title">Step A: Genre-Based Recommendations</h2>

            <div class="control-panel">
                <label for="movie-select" class="control-label">
                    Choose a movie from the dataset
                </label>
                <select id="movie-select">
                    <!-- Options will be populated dynamically -->
                </select>

                <button id="recommend-btn" type="button" onclick="getRecommendations()">
                    Get Recommendations
                </button>
            </div>

            <div id="result-box">
                <p id="result">Loading data. Please wait...</p>
            </div>
        </section>

        <!-- LLM Feature Engineering Workflow (4 stages from tutorial) -->
        <section id="llm-panel" class="section-block">
            <h2 class="section-title">Step B: LLM-Powered Feature Engineering Workflow</h2>
            <p class="llm-note">
                This panel follows the 4-stage tutorial: Read Raw Data, Extract Features, Consolidate Keywords, Finalize and Encode.
                Paste a raw movie description then generate example LLM prompts you can send to a model like phi-3-mini-instruct.
            </p>

            <!-- Stage 1: Read Raw Data (non LLM) -->
            <div class="llm-stage">
                <h3>Stage 1 — Read Raw Data (Data Engineering, no LLM)</h3>
                <p class="stage-description">
                    Input is a database or CSV column with unstructured text such as
                    “A young farm boy named Luke Skywalker joins a rebel alliance to destroy a planet-destroying space station,
                    learning a mystical power called the Force along the way”.
                    This step reads raw text and does basic cleaning but does not call an LLM.
                </p>
            </div>

            <!-- Raw text input used by Stages 2–4 -->
            <label for="raw-description" class="control-label">
                Raw movie description (input for Stages 2, 3 and 4)
            </label>
            <textarea id="raw-description"
                      placeholder="Paste the movie description here..."></textarea>

            <button id="llm-generate-btn" type="button" onclick="generateLLMPrompts()">
                Generate LLM Prompts for Stages 2–4
            </button>

            <!-- Stage 2: Extract Features -->
            <div class="llm-stage">
                <h3>Stage 2 — Extract Features (LLM Task)</h3>
                <p class="stage-description">
                    Input: raw movie description from Stage 1.
                    Output: a set of extracted features such as sub-genre and themes in JSON format.
                    This matches the tutorial example
                    {"sub-genre": ["Space Opera"], "themes": ["Good vs Evil", "Coming of Age", "Hope"]}.
                </p>
                <pre id="prompt-extract" class="prompt-box"></pre>
            </div>

            <!-- Stage 3: Consolidate Keywords -->
            <div class="llm-stage">
                <h3>Stage 3 — Consolidate Keywords (LLM Task)</h3>
                <p class="stage-description">
                    Input: extracted raw keywords from many movies such as
                    ["Space Opera", "Sci-Fi", "Science Fiction", "Galactic Adventure"].
                    Output: curated master lists of canonical sub-genres and themes such as
                    Sub-genres: ["Science Fiction", "Fantasy", "Action Thriller", ...]
                    Themes: ["Good vs Evil", "Coming of Age", "Redemption", "Sacrifice", ...].
                </p>
                <pre id="prompt-consolidate" class="prompt-box"></pre>
            </div>

            <!-- Stage 4: Finalize & Encode -->
            <div class="llm-stage">
                <h3>Stage 4 — Finalize and Encode (LLM Task + One-Hot)</h3>
                <p class="stage-description">
                    Input: 1) raw movie description and 2) master lists from Stage 3.
                    Output: a final consistent set of features such as
                    {"sub_genre": ["Science Fiction"], "themes": ["Good vs Evil", "Coming of Age"]}.
                    These can be one-hot encoded into vectors like
                    Sub-genre: [0, 1, 0, ...]
                    Themes: [1, 1, 0, 0, ...].
                </p>
                <pre id="prompt-finalize" class="prompt-box"></pre>
            </div>
        </section>
    </div>

    <!-- Data handling module must load first -->
    <script src="data.js"></script>
    <!-- UI and recommendation logic -->
    <script src="script.js"></script>
</body>
</html>
